<h3>Rota for <%= @rota.procurement_area_name %></h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <% @rota.shifts.each do |shift| %>
      <th>
      <%= @rota.location_for_shift(shift).try(:name) %>
      </br>
      <%= shift.info %>
      </th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @rota.grouped_slots_by_date.each do |date, slots| %>
    <tr>
      <td><%= date.strftime("%A, %-d %b %Y") %></td>

      <% @rota.shifts.each do |shift| %>
        <td>
        <%= slots.select { |s| s.shift_id == shift.id }.
          map(&:organisation_uid).
          map { |o| @rota.organisations.detect { |os| os.uid == o }}.
          map(&:name).
          join("</br></br>").
          html_safe %>
        </td>
      <% end %>
    </tr>
  <% end %>
  </tbody>
</table>
